# Hack until Buck can provide the JDK include path automatically.
# If JAVA_HOME is defined, we will use it.
# Otherwise, just fake it with typedefs.
import os
if 'JAVA_HOME' in os.environ:
  cppflags = [
    '-DUSE_JNI_H',
    '-I' + os.environ['JAVA_HOME'] + '/include',
    '-I' + os.environ['JAVA_HOME'] + '/include/linux',
  ]
else:
  cppflags = []



java_library(
  name = 'jlib',
  srcs = ['JLib.java'],
  deps = [
    ':jlib-native',
  ],
)

cxx_library(
  name = 'jlib-native',
  preprocessor_flags = cppflags,
  srcs = ['jlib.c'],
)

prebuilt_jar(
  name = 'junit-jar',
  binary_jar = 'junit-4.11.jar',
)

prebuilt_jar(
  name = 'hamcrest-jar',
  binary_jar = 'hamcrest-core-1.3.jar',
)

java_test(
  name = 'jtest',
  srcs = ['JTest.java'],
  use_cxx_libraries = True,
  deps = [
    ':jlib',
    ':junit-jar',
    ':hamcrest-jar',
  ],
)
